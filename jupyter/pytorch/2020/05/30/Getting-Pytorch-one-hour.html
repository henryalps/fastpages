<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Pytorch一小时入门 | Henrys’ Lab</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Pytorch一小时入门" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="抄写一遍Pytorch入门代码" />
<meta property="og:description" content="抄写一遍Pytorch入门代码" />
<link rel="canonical" href="https://henryalps.github.io/fastpages/jupyter/pytorch/2020/05/30/Getting-Pytorch-one-hour.html" />
<meta property="og:url" content="https://henryalps.github.io/fastpages/jupyter/pytorch/2020/05/30/Getting-Pytorch-one-hour.html" />
<meta property="og:site_name" content="Henrys’ Lab" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-05-30T00:00:00-05:00" />
<script type="application/ld+json">
{"datePublished":"2020-05-30T00:00:00-05:00","dateModified":"2020-05-30T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://henryalps.github.io/fastpages/jupyter/pytorch/2020/05/30/Getting-Pytorch-one-hour.html"},"description":"抄写一遍Pytorch入门代码","@type":"BlogPosting","url":"https://henryalps.github.io/fastpages/jupyter/pytorch/2020/05/30/Getting-Pytorch-one-hour.html","headline":"Pytorch一小时入门","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/fastpages/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://henryalps.github.io/fastpages/feed.xml" title="Henrys' Lab" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-165367915-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>

<link rel="shortcut icon" type="image/x-icon" href="/fastpages/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Pytorch一小时入门 | Henrys’ Lab</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Pytorch一小时入门" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="抄写一遍Pytorch入门代码" />
<meta property="og:description" content="抄写一遍Pytorch入门代码" />
<link rel="canonical" href="https://henryalps.github.io/fastpages/jupyter/pytorch/2020/05/30/Getting-Pytorch-one-hour.html" />
<meta property="og:url" content="https://henryalps.github.io/fastpages/jupyter/pytorch/2020/05/30/Getting-Pytorch-one-hour.html" />
<meta property="og:site_name" content="Henrys’ Lab" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-05-30T00:00:00-05:00" />
<script type="application/ld+json">
{"datePublished":"2020-05-30T00:00:00-05:00","dateModified":"2020-05-30T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://henryalps.github.io/fastpages/jupyter/pytorch/2020/05/30/Getting-Pytorch-one-hour.html"},"description":"抄写一遍Pytorch入门代码","@type":"BlogPosting","url":"https://henryalps.github.io/fastpages/jupyter/pytorch/2020/05/30/Getting-Pytorch-one-hour.html","headline":"Pytorch一小时入门","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://henryalps.github.io/fastpages/feed.xml" title="Henrys' Lab" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-165367915-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/fastpages/">Henrys&#39; Lab</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/fastpages/about/">About</a><a class="page-link" href="/fastpages/search/">Search</a><a class="page-link" href="/fastpages/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Pytorch一小时入门</h1><p class="page-description">抄写一遍Pytorch入门代码</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-05-30T00:00:00-05:00" itemprop="datePublished">
        May 30, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      1 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/fastpages/categories/#jupyter">jupyter</a>
        &nbsp;
      
        <a class="category-tags-link" href="/fastpages/categories/#pytorch">pytorch</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/henryalps/fastpages/tree/master/_notebooks/2020-05-04-fastpages.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/fastpages/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/henryalps/fastpages/master?filepath=_notebooks%2F2020-05-04-fastpages.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/fastpages/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/henryalps/fastpages/blob/master/_notebooks/2020-05-04-fastpages.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/fastpages/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#理解PyTorch的Tensor库">理解PyTorch的Tensor库 </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Tesnsor的定义">Tesnsor的定义 </a></li>
<li class="toc-entry toc-h2"><a href="#Tensor操作">Tensor操作 </a></li>
<li class="toc-entry toc-h2"><a href="#Numpy桥接---在tensor与numpy数组之间互相转换">Numpy桥接 - 在tensor与numpy数组之间互相转换 </a></li>
<li class="toc-entry toc-h2"><a href="#GPU上的tensor">GPU上的tensor </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Autograd自动求导的应用">Autograd自动求导的应用 </a>
<ul>
<li class="toc-entry toc-h2"><a href="#tensor">tensor </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#神经网络">神经网络 </a>
<ul>
<li class="toc-entry toc-h2"><a href="#定义网络">定义网络 </a></li>
<li class="toc-entry toc-h2"><a href="#损失函数">损失函数 </a></li>
<li class="toc-entry toc-h2"><a href="#反向传播">反向传播 </a></li>
<li class="toc-entry toc-h2"><a href="#权重更新">权重更新 </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#训练一个分类器">训练一个分类器 </a>
<ul>
<li class="toc-entry toc-h2"><a href="#数据在哪里？">数据在哪里？ </a></li>
<li class="toc-entry toc-h2"><a href="#训练图片分类器">训练图片分类器 </a>
<ul>
<li class="toc-entry toc-h3"><a href="#1.-读取与正则化CIFAR10数据集">1. 读取与正则化CIFAR10数据集 </a></li>
<li class="toc-entry toc-h3"><a href="#2.定义一个CNN">2.定义一个CNN </a></li>
<li class="toc-entry toc-h3"><a href="#3.定义损失函数和优化器">3.定义损失函数和优化器 </a></li>
<li class="toc-entry toc-h3"><a href="#4.训练网络">4.训练网络 </a></li>
<li class="toc-entry toc-h3"><a href="#5.测试网络在测试集上的效果">5.测试网络在测试集上的效果 </a></li>
<li class="toc-entry toc-h3"><a href="#在GPU上运行">在GPU上运行 </a></li>
</ul>
</li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-05-30-Getting-Pytorch-one-hour.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>更新记录：</p>
<blockquote>
<p>20/05/31(I) 完成前两节（30min）的内容</p>
<p>20/05/31(II) 完成后两节（30min）的内容</p>
</blockquote>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>学习了<a href="https://pytorch.org/tutorials/beginner/deep_learning_60min_blitz.html">DEEP LEARNING WITH PYTORCH: A 60 MINUTE BLITZ</a>，将过程记录在此处。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><figure>
  
    <img class="docimage" src="/fastpages/images/copied_from_nb/9169772538.png" alt="9169772538.png">
    
    
      <figcaption>9169772538.png</figcaption>
    
</figure>
</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>1.理解PyTorch的Tensor库</li>
<li>2.Autograd自动求导的应用</li>
<li>3.构建神经网络</li>
<li>4.一个实际的例子</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="理解PyTorch的Tensor库">
<a class="anchor" href="#%E7%90%86%E8%A7%A3PyTorch%E7%9A%84Tensor%E5%BA%93" aria-hidden="true"><span class="octicon octicon-link"></span></a>理解PyTorch的Tensor库<a class="anchor-link" href="#%E7%90%86%E8%A7%A3PyTorch%E7%9A%84Tensor%E5%BA%93"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tesnsor的定义">
<a class="anchor" href="#Tesnsor%E7%9A%84%E5%AE%9A%E4%B9%89" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tesnsor的定义<a class="anchor-link" href="#Tesnsor%E7%9A%84%E5%AE%9A%E4%B9%89"> </a>
</h2>
<p>Tensors和NumPy的ndarray结构很像，区别是Tensor可以用于GPU计算。</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="c1"># check the GPU support</span>
<span class="nb">dir</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>['BFloat16Storage',
 'BFloat16Tensor',
 'BoolStorage',
 'BoolTensor',
 'ByteStorage',
 'ByteTensor',
 'CharStorage',
 'CharTensor',
 'CudaError',
 'DeferredCudaCallError',
 'DoubleStorage',
 'DoubleTensor',
 'Event',
 'FloatStorage',
 'FloatTensor',
 'HalfStorage',
 'HalfTensor',
 'IntStorage',
 'IntTensor',
 'LongStorage',
 'LongTensor',
 'PIPE',
 'Popen',
 'ShortStorage',
 'ShortTensor',
 'Stream',
 '_CudaBase',
 '_StorageBase',
 '__builtins__',
 '__cached__',
 '__doc__',
 '__file__',
 '__loader__',
 '__name__',
 '__package__',
 '__path__',
 '__spec__',
 '_after_fork',
 '_check_capability',
 '_check_driver',
 '_cudart',
 '_dummy_type',
 '_free_mutex',
 '_get_device_index',
 '_host_allocator',
 '_in_bad_fork',
 '_initialized',
 '_lazy_call',
 '_lazy_init',
 '_lazy_new',
 '_load_cudart',
 '_original_pid',
 '_queued_calls',
 '_register_after_fork',
 '_sleep',
 '_utils',
 'check_error',
 'comm',
 'contextlib',
 'ctypes',
 'cudaStatus',
 'cudart',
 'current_blas_handle',
 'current_device',
 'current_stream',
 'default_stream',
 'device',
 'device_count',
 'device_of',
 'empty_cache',
 'find_cuda_windows_lib',
 'get_device_capability',
 'get_device_name',
 'get_device_properties',
 'get_rng_state',
 'get_rng_state_all',
 'init',
 'initial_seed',
 'ipc_collect',
 'is_available',
 'manual_seed',
 'manual_seed_all',
 'max_memory_allocated',
 'max_memory_cached',
 'memory_allocated',
 'memory_cached',
 'nccl',
 'nvtx',
 'os',
 'platform',
 'profiler',
 'raise_from',
 'random',
 'reset_max_memory_allocated',
 'reset_max_memory_cached',
 'seed',
 'seed_all',
 'set_device',
 'set_rng_state',
 'set_rng_state_all',
 'sparse',
 'stream',
 'streams',
 'synchronize',
 'sys',
 'torch',
 'traceback',
 'warnings']</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>创建一个5x3张量，不初始化</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([[ 8.4078e-45,  0.0000e+00,  2.6136e-28],
        [ 5.5772e-43, -1.3120e-30,  4.5915e-41],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-1.3120e-30,  4.5915e-41,  0.0000e+00]])
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>???这里的表现和页面不一样，预期应该是全0才对</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>创建一个随机初始化张量</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([[0.3783, 0.4491, 0.0897],
        [0.2913, 0.1618, 0.6047],
        [0.2112, 0.3987, 0.1202],
        [0.8236, 0.2970, 0.4896],
        [0.4792, 0.2471, 0.6751]])
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>创建一个填0的long型张量</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">long</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]])
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>从数据中直接创建一个张量</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">5.5</span><span class="p">,</span><span class="mf">3.0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([5.5000, 3.0000])
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>根据一个已有张量创建张量</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 创建一个类型变为double型的全1张量</span>
<span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">new_ones</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">x</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">randn_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([[1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.]], dtype=torch.float64)
tensor([[ 0.4722, -0.4380, -1.0941],
        [ 0.6054,  0.6555, -1.1304],
        [-1.1721,  1.3889,  0.3657],
        [-1.6273, -0.0502,  0.8097],
        [ 1.3560,  0.1341,  1.6279]])
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>torch.size实际是一个tuple</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>torch.Size([5, 3])
5
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tensor操作">
<a class="anchor" href="#Tensor%E6%93%8D%E4%BD%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tensor操作<a class="anchor-link" href="#Tensor%E6%93%8D%E4%BD%9C"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>加法之两种符号类型</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 类型1- 直接用加号</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># 类型2- 使用函数add</span>
<span class="nb">print</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([[1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.]])
tensor([[1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.]])
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>？？？为何要用两种符号表示呢</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>加法之指定结果tensor</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">out</span><span class="o">=</span><span class="n">result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([[1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.]])
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>加法之原位相加</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span><span class="o">.</span><span class="n">add_</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([[1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.]])
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>注意到所有原位运算都是在函数名后边加一个下划线</em></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>使用类似numpy的范围写法取tensor的部分值</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 打印x的第一列</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># 打印x的第一行</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([1., 1., 1., 1., 1.])
tensor([1., 1., 1.])
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>改变tensor的维度</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="c1"># 只指定每行的元素数量，就可以计算出变换后的形状</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([[ 1.7866,  1.8163, -0.4897,  0.6796],
        [-1.1594,  1.8653, -0.4756, -0.8084],
        [ 0.5253,  1.8867,  1.2337, -0.1705],
        [ 0.6688,  0.0531, -0.9582, -0.4612]]) tensor([ 1.7866,  1.8163, -0.4897,  0.6796, -1.1594,  1.8653, -0.4756, -0.8084,
         0.5253,  1.8867,  1.2337, -0.1705,  0.6688,  0.0531, -0.9582, -0.4612]) tensor([[ 1.7866,  1.8163],
        [-0.4897,  0.6796],
        [-1.1594,  1.8653],
        [-0.4756, -0.8084],
        [ 0.5253,  1.8867],
        [ 1.2337, -0.1705],
        [ 0.6688,  0.0531],
        [-0.9582, -0.4612]])
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>tensor的操作还有很多，此处实际没有完全列举</em></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Numpy桥接---在tensor与numpy数组之间互相转换">
<a class="anchor" href="#Numpy%E6%A1%A5%E6%8E%A5---%E5%9C%A8tensor%E4%B8%8Enumpy%E6%95%B0%E7%BB%84%E4%B9%8B%E9%97%B4%E4%BA%92%E7%9B%B8%E8%BD%AC%E6%8D%A2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Numpy桥接 - 在tensor与numpy数组之间互相转换<a class="anchor-link" href="#Numpy%E6%A1%A5%E6%8E%A5---%E5%9C%A8tensor%E4%B8%8Enumpy%E6%95%B0%E7%BB%84%E4%B9%8B%E9%97%B4%E4%BA%92%E7%9B%B8%E8%BD%AC%E6%8D%A2"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>numpy数组和tensor共享内存：这意味着对任何一个变量的改变都将同步到另一个上。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>转化tensor为一个ndarray</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">b</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([1., 1., 1., 1., 1.]) [1. 1. 1. 1. 1.]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>对tensor的改变将会反映到ndarray上</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">add_</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[2. 2. 2. 2. 2.]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>对ndarray的改变将会反映到tensor上</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span><span class="o">+=</span><span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([3., 3., 3., 3., 3.])
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>将ndarray转换为tensor</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1">#注意此处的变量命名</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">out</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[2. 2. 2. 2. 2.]
tensor([2., 2., 2., 2., 2.], dtype=torch.float64)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="GPU上的tensor">
<a class="anchor" href="#GPU%E4%B8%8A%E7%9A%84tensor" aria-hidden="true"><span class="octicon octicon-link"></span></a>GPU上的tensor<a class="anchor-link" href="#GPU%E4%B8%8A%E7%9A%84tensor"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>使用to()方法将tensor迁移到其它设备</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cuda"</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">"cpu"</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">int</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([[ 2.7866,  2.8163,  0.5103,  1.6796],
        [-0.1594,  2.8653,  0.5244,  0.1916],
        [ 1.5253,  2.8867,  2.2337,  0.8295],
        [ 1.6688,  1.0531,  0.0418,  0.5388]], device='cuda:0')
tensor([[2, 2, 0, 1],
        [0, 2, 0, 0],
        [1, 2, 2, 0],
        [1, 1, 0, 0]], dtype=torch.int32)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Autograd自动求导的应用">
<a class="anchor" href="#Autograd%E8%87%AA%E5%8A%A8%E6%B1%82%E5%AF%BC%E7%9A%84%E5%BA%94%E7%94%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a>Autograd自动求导的应用<a class="anchor-link" href="#Autograd%E8%87%AA%E5%8A%A8%E6%B1%82%E5%AF%BC%E7%9A%84%E5%BA%94%E7%94%A8"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>pytorch中神经网络的核心模块就是<code>autograd</code>包，我们简单地了解一下这个包，其后就可以开始训练我们的第一个神经网络了。</p>
<p><code>autograd</code>包可以对所有的tensor操作进行自动差分（？？？如何自定义运算符）。它是一个define-by-run的框架，也就是你的反向传播是由代码运行方式所决定的，每一个操作都会有不同。</p>
<p>我们用更简单的方式和例子进行解释。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="tensor">
<a class="anchor" href="#tensor" aria-hidden="true"><span class="octicon octicon-link"></span></a>tensor<a class="anchor-link" href="#tensor"> </a>
</h2>
<p><code>torch.Tensor</code>是这个包的核心。如果你将其属性<code>.requires_grad</code>设为True，它将追踪其上的所有操作。当你完成计算后，可以调用<code>.backward()</code>方法以自动计算所有导数。这个tensor的导数将由<code>.grad</code>参数所体现。</p>
<p>为了结束对一个tensor求导的操作，你可以用<code>.detach</code>方法将它从计算历史中移除，以避免之后它又被继续求导。</p>
<p>为了避免对tensor求导占用内存，你可以将代码块用<code>with torch.no_grad()</code>包裹起来。这对模型评估尤其有用，因为其中可能存在设置了<code>require_grad=True</code>的参数，但我们却不需要求导数。</p>
<p><code>Function</code>类是另外一个非常常用的类。</p>
<p><code>Tensor</code>和<code>Function</code>共同作用以构建一个无环图，该图对完整的计算历史进行编码。每个tensor都有一个<code>.grad_fn</code>属性，其中保存了创建这个tensor的<code>Function</code>对象。（用户自己创建的tensor则没有这个属性）</p>
<p>如果你想计算导数，你可以调用tensor的<code>.backward()</code>方法。如果tensor是一个标量（即包含单个元素），你不需要为<code>backward()</code>指定任何参数。但如果它有多于一个元素，则你必需为它指定<code>gradient</code>参数，其形状与该tensor对应。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>创建一个tensor并设定<code>require_grad</code>为True以追踪其上的计算：</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([[1., 1.],
        [1., 1.]], requires_grad=True)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>tensor运算</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([[3., 3.],
        [3., 3.]], grad_fn=&lt;AddBackward0&gt;)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>更多的tensor运算</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="mi">3</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([[27., 27.],
        [27., 27.]], grad_fn=&lt;MulBackward0&gt;) tensor(27., grad_fn=&lt;MeanBackward0&gt;)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p><code>.requires_grad_()</code>可用于替换一个已有tensor的<code>require_grad</code>标志位。输入标志位默认为<code>False</code>。</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">a</span><span class="o">=</span><span class="p">((</span><span class="n">a</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">grad_fn</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">requires_grad_</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">grad_fn</span><span class="p">)</span>
<span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">grad_fn</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>False
None
True
None
&lt;SumBackward0 object at 0x00000240968298D0&gt;
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>进行反向传播。由于<code>out</code>是一个标量，所以无需传入参数</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">out</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">grad</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([[4.5000, 4.5000],
        [4.5000, 4.5000]])
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>如果我们将out定义为$o$,那么我们将有$o=\frac{1}{4}\sum_{i}3(x_i+2)^2$,此时$\frac{\partial o}{\partial x_i}=\frac{3}{2}(x_i+2)$,因此$\frac{\partial o}{\partial x_i} \mid_{x_i=1}=4.5$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>数学上来说，如果你有一个因自变量都为向量的函数$\vec{y}=f(\vec{x})$,那么$\vec{y}$对$\vec{x}$的导数为一个雅可比矩阵：</p>
<p>$J=\left(\begin{array}{ccc}
\frac{\partial y_{1}}{\partial x_{1}} &amp; \cdots &amp; \frac{\partial y_{1}}{\partial x_{n}} \\
\vdots &amp; \ddots &amp; \vdots \\
\frac{\partial y_{m}}{\partial x_{1}} &amp; \cdots &amp; \frac{\partial y_{m}}{\partial x_{n}}
\end{array}\right)$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>一般地，<code>torch.autograd</code>是一个用于计算向量-雅可比行列式乘积的工具。也就是说，给定任何向量$v=(v_1 v_2 ... v_m)^T$，如果$v$刚好是标量函数$l=g(\vec{y})$的导数，也就是说$v=\left(\frac{\partial l}{\partial y_{1}} \cdots \frac{\partial l}{\partial y_{m}}\right)^{T}$，那么根据链式法则有向量与雅克比行列式之积为
$J^{T} \cdot v=\left(\begin{array}{ccc}
\frac{\partial y_{1}}{\partial x_{1}} &amp; \cdots &amp; \frac{\partial y_{m}}{\partial x_{1}} \\
\vdots &amp; \ddots &amp; \vdots \\
\frac{\partial y_{1}}{\partial x_{n}} &amp; \cdots &amp; \frac{\partial y_{m}}{\partial x_{n}}
\end{array}\right)\left(\begin{array}{c}
\frac{\partial l}{\partial y_{1}} \\
\frac{\partial l}{\partial y_{m}}
\end{array}\right)=\left(\begin{array}{c}
\frac{\partial l}{\partial x_{1}} \\
\frac{\partial l}{\partial x_{n}}
\end{array}\right)$</p>
<p>向量与雅克比行列式之积的这种性质使得，将额外的导数引入输出不为常量的模型非常方便。
现在我们看一下向量-雅克比积的一个例子：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>

<span class="k">while</span> <span class="n">y</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">&lt;</span><span class="mi">1000</span><span class="p">:</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">*</span><span class="mi">2</span>

<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([-800.3267,  194.5804,  608.2095], grad_fn=&lt;MulBackward0&gt;)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>在这个例子中<code>y</code>不再是一个标量了。<code>torch.autograd</code>不能直接计算完整的雅克比行列式，但如果我们只想要向量-雅克比行列式之积的话，就简单将向量传入<code>backward</code>参数即可：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0001</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">grad</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([5.1200e+01, 5.1200e+02, 5.1200e-02])
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>关于上面这一段<a href="https://zhuanlan.zhihu.com/p/29923090">知乎链接</a>讲的比较清楚，主要动机是不允许tensor对tensor求导，只允许scalar对tensor求导。</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>如果想对已经设置<code>requires_grad=True</code>的张量停止自动求导，有两种方式：</p>
<p>1.使用<code>with torch.no_grad()</code>包裹</p>
<p>2.使用<code>.detach()</code>获取一个新的不需导数的张量</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">)</span>
<span class="nb">print</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">)</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">)</span>
    
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>True
True
False
True
False
tensor(True)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="神经网络">
<a class="anchor" href="#%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>神经网络<a class="anchor-link" href="#%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>torch.nn</code>用于构建神经网络。</p>
<p>现在你已经了解了<code>autograd</code>包，<code>nn</code>依赖<code>autograd</code>以定义模型并对其求差分。<code>nn.Module</code>的一个实例会包含网络层，以及一个<code>forward(input)</code>方法用于返回<code>output</code>。</p>
<p>如，看看下边这个定义用于对位图分类的网络：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><figure>
  
    <img class="docimage" src="/fastpages/images/copied_from_nb/4864202438.png" alt="4864202438.png">
    
    
      <figcaption>4864202438.png</figcaption>
    
</figure>
</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>上图是一个简单的前向网络，它接收输入，依次喂给几层，最终得到输出。
一个典型的训练过程如下：</p>
<ul>
<li>定义有一些可训练参数的网络</li>
<li>输入一组数据</li>
<li>前向传播</li>
<li>计算损失函数值</li>
<li>反向传播获取梯度</li>
<li>更新网络权重，通常使用<code>weight=weight-learning_rate*gradient</code>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="定义网络">
<a class="anchor" href="#%E5%AE%9A%E4%B9%89%E7%BD%91%E7%BB%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>定义网络<a class="anchor-link" href="#%E5%AE%9A%E4%B9%89%E7%BD%91%E7%BB%9C"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>以下代码用于定义网络：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>

<span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># 输入只有一个灰度channel，输出为6个channel，每个channel为3*3卷积获取</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="c1"># 尾部的全连接层</span>
        <span class="c1"># 3*3卷积得到的输出是6*6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">16</span><span class="o">*</span><span class="mi">6</span><span class="o">*</span><span class="mi">6</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">84</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">84</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">num_flat_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="c1"># batch维不会被压平</span>
        <span class="n">num_features</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">size</span><span class="p">:</span>
            <span class="n">num_features</span> <span class="o">*=</span> <span class="n">s</span>
        <span class="k">return</span> <span class="n">num_features</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># 做最大池化以下采样</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">max_pool2d</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="c1"># 如果是用的方阵的话也可以只写行数或列数</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">max_pool2d</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="c1"># 形状变换</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_flat_features</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>

<span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Net(
  (conv1): Conv2d(1, 6, kernel_size=(3, 3), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(3, 3), stride=(1, 1))
  (fc1): Linear(in_features=576, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你必需定义<code>forward</code>方法。<code>backward</code>方法会在指定<code>autograd</code>时自动计算得到。<code>forard</code>方法中可以用任意tensor操作。</p>
<p>网络可学习的参数由<code>net.parameters()</code>导出：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>10
torch.Size([6, 1, 3, 3])
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>我们测试一个随机的32x32输入。注意这个网络的输入大小是32x32。为了在MNIST数据集上使用这个网络，必需将数据的大小变换为32x32:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([[-0.0251, -0.0923, -0.0807, -0.0411,  0.1351,  0.1501,  0.0616, -0.0283,
          0.1091,  0.1278]], grad_fn=&lt;AddmmBackward&gt;)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>清空所有参数的梯度缓存，使用随机梯度进行反向传播：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
<span class="o">??</span>torch.nn.Module.zero_grad
<span class="c1"># 这里为何要用随机，不用ones呢</span>
<span class="n">out</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea ">
<pre><span class="ansi-red-intense-fg ansi-bold">Signature:</span> torch<span class="ansi-yellow-intense-fg ansi-bold">.</span>nn<span class="ansi-yellow-intense-fg ansi-bold">.</span>Module<span class="ansi-yellow-intense-fg ansi-bold">.</span>zero_grad<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-red-intense-fg ansi-bold">Source:</span>   
    <span class="ansi-green-intense-fg ansi-bold">def</span> zero_grad<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">
</span>        <span class="ansi-blue-intense-fg ansi-bold">r"""Sets gradients of all model parameters to zero."""</span><span class="ansi-yellow-intense-fg ansi-bold">
</span>        <span class="ansi-green-intense-fg ansi-bold">for</span> p <span class="ansi-green-intense-fg ansi-bold">in</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>parameters<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">
</span>            <span class="ansi-green-intense-fg ansi-bold">if</span> p<span class="ansi-yellow-intense-fg ansi-bold">.</span>grad <span class="ansi-green-intense-fg ansi-bold">is</span> <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">None</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">
</span>                p<span class="ansi-yellow-intense-fg ansi-bold">.</span>grad<span class="ansi-yellow-intense-fg ansi-bold">.</span>detach_<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">
</span>                p<span class="ansi-yellow-intense-fg ansi-bold">.</span>grad<span class="ansi-yellow-intense-fg ansi-bold">.</span>zero_<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-red-intense-fg ansi-bold">File:</span>      c:\users\henryalps\anaconda3\envs\pytorch\lib\site-packages\torch\nn\modules\module.py
<span class="ansi-red-intense-fg ansi-bold">Type:</span>      function
</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>*注意
<code>torch.nn</code>只支持mini-batch，这意味着<code>torch.nn</code>包只支持以mini-batch形式输入的sample，不支持单个sample。</p>
<p>比如<code>nn.Conv2d</code>接受的是一个4D Tensor:</p>
<p><figure>
  
    <img class="docimage" src="/fastpages/images/copied_from_nb/5969324360.png" alt="5969324360.png">
    
    
      <figcaption>5969324360.png</figcaption>
    
</figure>

如果你只有一个样本，需要用<code>input.unsqueeze(0)</code>添加一个假的batch维度。
*</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>在继续之前，先回顾一下我们见过的所有类：
<strong>回顾</strong></p>
<p>*
<code>torch.Tensor</code> - 是一个支持<code>backwrd()</code>形式的自动差分操作的多维数组。他也持有梯度值；</p>
<ul>
<li>
<p><code>nn.Module</code> 神经网络模块，方便打包模型参数以加载、导出或者迁移。</p>
</li>
<li>
<p><code>nn.Parameter</code> 在配置为Module的属性时，会被自动注册为模型参数。</p>
</li>
<li>
<p><code>autograd.Function</code> 每个Tensor操作创建至少一个Function节点，该节点与一个创建Tensor的方法相关联。</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>我们已经做的</strong></p>
<ul>
<li>定义一个神经网络</li>
<li>处理输入并反向传播</li>
</ul>
<p><strong>待做的</strong></p>
<ul>
<li>计算loss</li>
<li>更新网络权重</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="损失函数">
<a class="anchor" href="#%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>损失函数<a class="anchor-link" href="#%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>损失函数接受（输出，目标）格式输入，并计算出一个值，用于衡量输出与目标之间的偏离程度。</p>
<p>nn包提供了几种不同的损失函数。<code>nn.MSELoss</code>计算了输入与目标之间的均方误差。</p>
<p>比如：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>

<span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor(0.9722, grad_fn=&lt;MseLossBackward&gt;)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>现在，如果你用<code>.grad_fn</code>去跟随loss的反向传播过程，你会看到一个这样的计算图：
<code>input -&gt; conv2d -&gt; relu -&gt; maxpool2d -&gt; conv2d -&gt; relu -&gt; maxpool2d 
-&gt; view -&gt; linear -&gt; relu -&gt; linear  -&gt; relu -&gt; linear
-&gt; MSELoss
-&gt; loss</code>
所以当我们调用<code>loss.backward()</code>时，整个计算图对loss求梯度，图中设置<code>require_grad=True</code>的Tensor将把它们的<code>.grad</code>属性与梯度相加。</p>
<p>比如，我们回溯几步：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">grad_fn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">grad_fn</span><span class="o">.</span><span class="n">next_functions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">grad_fn</span><span class="o">.</span><span class="n">next_functions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">next_functions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;MseLossBackward object at 0x00000250CC0A7278&gt;
&lt;AddmmBackward object at 0x00000250CC0A7198&gt;
&lt;AccumulateGrad object at 0x00000250CC0A7278&gt;
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="反向传播">
<a class="anchor" href="#%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD" aria-hidden="true"><span class="octicon octicon-link"></span></a>反向传播<a class="anchor-link" href="#%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>为了反向传播误差，我们必须手动调用<code>loss.backward()</code>。调用之前需要清除已有的梯度值，否则会累加到已有的梯度值上。</p>
<p>现在我们需要调用<code>loss.backward()</code>，并分别在调用前和调用后查看convI的偏差值。</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'conv1.bias.grad befor backward'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">conv1</span><span class="o">.</span><span class="n">bias</span><span class="o">.</span><span class="n">grad</span><span class="p">)</span>

<span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'conv1.bias.grad after backward'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">conv1</span><span class="o">.</span><span class="n">bias</span><span class="o">.</span><span class="n">grad</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>conv1.bias.grad befor backward
tensor([0., 0., 0., 0., 0., 0.])
conv1.bias.grad after backward
tensor([ 0.0108, -0.0118,  0.0027, -0.0026,  0.0037,  0.0074])
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>现在，我们知道了如何应用损失函数。</p>
<p>需要学习的只有一个：</p>
<ul>
<li>更新网络的权重。</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="权重更新">
<a class="anchor" href="#%E6%9D%83%E9%87%8D%E6%9B%B4%E6%96%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>权重更新<a class="anchor-link" href="#%E6%9D%83%E9%87%8D%E6%9B%B4%E6%96%B0"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>最简单的权重更新规则是随机梯度下降（SGD），如下：
<code>weight = weight - learning_rate * gradient</code>
我们可以用简单的python代码实现该功能：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>learning_rate = 0.01
for f in net.parameters():
    f.data.sub_(f.grad.date * learning_rate)</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>但是，在你使用网络时，你可能想用不同的更新规则如Adam、RMSProp等。为了支持这些更新规则，我们创建了一个轻量包<code>torch.optim</code>以实现这些方法。使用非常简单：</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>

<span class="c1"># 创建优化器</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="c1"># 在训练的过程中</span>
<span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>注意梯度缓存必须手动用<code>optimizer.zero_grad()方式清除，这是因为梯度是一个累加值</code></em></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="训练一个分类器">
<a class="anchor" href="#%E8%AE%AD%E7%BB%83%E4%B8%80%E4%B8%AA%E5%88%86%E7%B1%BB%E5%99%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a>训练一个分类器<a class="anchor-link" href="#%E8%AE%AD%E7%BB%83%E4%B8%80%E4%B8%AA%E5%88%86%E7%B1%BB%E5%99%A8"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>你已经看到如何定义神经网络，计算损失并且更新网络的权重，现在你可能在思考。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="数据在哪里？">
<a class="anchor" href="#%E6%95%B0%E6%8D%AE%E5%9C%A8%E5%93%AA%E9%87%8C%EF%BC%9F" aria-hidden="true"><span class="octicon octicon-link"></span></a>数据在哪里？<a class="anchor-link" href="#%E6%95%B0%E6%8D%AE%E5%9C%A8%E5%93%AA%E9%87%8C%EF%BC%9F"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>通常，在你处理图像、文本、声音或影像数据时，你可以用标准的python包将数据读入一个numpy数组，此后你就可以将数组转为tensor：</p>
<ul>
<li>图像方面，Pillow或OpenCV都有用</li>
<li>声音方面，scipy或者librosa都有用</li>
<li>文本方面，原始的python、cython、NLTK或者SpaCy都有用</li>
</ul>
<p>特别的，对于视觉类任务，我们创建了一个名为torchvision的包，可以用于Imagenet，CIFAR10，MNIST等数据集的导入。
这使得我们得以避免重写一些数据载入的代码。</p>
<p>本教程中，我们将用 CIFAR 10数据集举例。该数据集包含10个类别，每个样本都是一个3<em>32</em>32的多维数组：
<figure>
  
    <img class="docimage" src="/fastpages/images/copied_from_nb/9638222999.png" alt="9638222999.png">
    
    
      <figcaption>9638222999.png</figcaption>
    
</figure>
</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="训练图片分类器">
<a class="anchor" href="#%E8%AE%AD%E7%BB%83%E5%9B%BE%E7%89%87%E5%88%86%E7%B1%BB%E5%99%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a>训练图片分类器<a class="anchor-link" href="#%E8%AE%AD%E7%BB%83%E5%9B%BE%E7%89%87%E5%88%86%E7%B1%BB%E5%99%A8"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>我们将依次进行下列操作：</p>
<p>1.读取和正则化CIFAR 10 训练和测试集
2.定义一个CNN
3.定义一个损失函数
4.在训练集上完成训练
5.使用测试集完成测试</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.-读取与正则化CIFAR10数据集">
<a class="anchor" href="#1.-%E8%AF%BB%E5%8F%96%E4%B8%8E%E6%AD%A3%E5%88%99%E5%8C%96CIFAR10%E6%95%B0%E6%8D%AE%E9%9B%86" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. 读取与正则化CIFAR10数据集<a class="anchor-link" href="#1.-%E8%AF%BB%E5%8F%96%E4%B8%8E%E6%AD%A3%E5%88%99%E5%8C%96CIFAR10%E6%95%B0%E6%8D%AE%E9%9B%86"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>使用<code>torchvision</code>时，读取CIFAR10数据集非常简单：</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torchvision</span>
<span class="kn">import</span> <span class="nn">torchvision.transforms</span> <span class="k">as</span> <span class="nn">transforms</span>
</pre></div>
<p>torchvision的输出是[0,1]之间的PILImage格式图片。我们将它们转化为[-1,1]之间的数据。
<code>如果你在windows上运行遇到BrokenPipeError，将torch.utils.data.DataLoader()的num_worker参数设置为0</code></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torchvision</span>
<span class="kn">import</span> <span class="nn">torchvision.transforms</span> <span class="k">as</span> <span class="nn">transforms</span>

<span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">(</span>
<span class="p">[</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">))])</span>

<span class="n">trainset</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">'../data'</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>

<span class="n">trainloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">trainset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">testset</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">'../data'</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>

<span class="n">testloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">testset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">classes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'plane'</span><span class="p">,</span><span class="s1">'car'</span><span class="p">,</span><span class="s1">'bird'</span><span class="p">,</span><span class="s1">'cat'</span><span class="p">,</span><span class="s1">'deer'</span><span class="p">,</span><span class="s1">'dog'</span><span class="p">,</span><span class="s1">'frog'</span><span class="p">,</span><span class="s1">'horse'</span><span class="p">,</span><span class="s1">'ship'</span><span class="p">,</span><span class="s1">'truck'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to ../data\cifar-10-python.tar.gz
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100.0%</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Extracting ../data\cifar-10-python.tar.gz to ../data
Files already downloaded and verified
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>我们看几张训练集中的图片：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span>
    <span class="n">npimg</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">npimg</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
<span class="n">dataiter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">trainloader</span><span class="p">)</span>
<span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">dataiter</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

<span class="c1"># 查看图片</span>
<span class="n">imshow</span><span class="p">(</span><span class="n">torchvision</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">make_grid</span><span class="p">(</span><span class="n">images</span><span class="p">))</span>
<span class="c1"># 打印类别</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">'</span><span class="si">%5s</span><span class="s1">'</span> <span class="o">%</span> <span class="n">classes</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>  cat   car   car  bird
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.定义一个CNN">
<a class="anchor" href="#2.%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AACNN" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.定义一个CNN<a class="anchor-link" href="#2.%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AACNN"> </a>
</h3>
<p>改造之前的CNN使其支持3个通道的图片：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>

<span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># 输入为3通道，输出为6个channel，每个channel为5*5卷积获取</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        <span class="c1"># ？ 之前用nn.functional.max_pool2d即可，现在换成nn.MaxPool2d了</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        <span class="c1"># 尾部的全连接层</span>
        <span class="c1"># 5*5卷积得到的输出变小了</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">16</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">84</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">84</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">num_flat_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="c1"># batch维不会被压平</span>
        <span class="n">num_features</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">size</span><span class="p">:</span>
            <span class="n">num_features</span> <span class="o">*=</span> <span class="n">s</span>
        <span class="k">return</span> <span class="n">num_features</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="c1"># 如果是用的方阵的话也可以只写行数或列数</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="c1"># 形状变换</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>

<span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Net(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.定义损失函数和优化器">
<a class="anchor" href="#3.%E5%AE%9A%E4%B9%89%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0%E5%92%8C%E4%BC%98%E5%8C%96%E5%99%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.定义损失函数和优化器<a class="anchor-link" href="#3.%E5%AE%9A%E4%B9%89%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0%E5%92%8C%E4%BC%98%E5%8C%96%E5%99%A8"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>我们用一个分类器交叉熵做为损失函数，并用带动量的SGD作为权重更新方法：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>

<span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4.训练网络">
<a class="anchor" href="#4.%E8%AE%AD%E7%BB%83%E7%BD%91%E7%BB%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.训练网络<a class="anchor-link" href="#4.%E8%AE%AD%E7%BB%83%E7%BD%91%E7%BB%9C"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>开始变得好玩了，我们只需要遍历我们的数据迭代器，将输入喂给网络并进行优化：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">running_loss</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trainloader</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span> <span class="c1"># 数据是一个序列</span>
        
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span> <span class="c1"># 清空梯度缓存</span>
        <span class="c1"># 前向传播</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
        <span class="c1"># 反向传播</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="c1"># 更新权重</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        
        <span class="c1"># 打印统计参数</span>
        <span class="n">running_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="k">2000</span> == 1999:
            <span class="nb">print</span><span class="p">(</span><span class="s1">'[</span><span class="si">%d</span><span class="s1">, </span><span class="si">%5d</span><span class="s1">] loss: </span><span class="si">%.3f</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">running_loss</span> <span class="o">/</span> <span class="mi">2000</span><span class="p">))</span>
            <span class="n">running_loss</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Finished Training'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[1,  2000] loss: 2.226
[1,  4000] loss: 1.888
[1,  6000] loss: 1.717
[1,  8000] loss: 1.610
[1, 10000] loss: 1.523
[1, 12000] loss: 1.481
Finished Training
[2,  2000] loss: 1.399
[2,  4000] loss: 1.367
[2,  6000] loss: 1.338
[2,  8000] loss: 1.311
[2, 10000] loss: 1.288
[2, 12000] loss: 1.294
Finished Training
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>最后保存我们训练好的模型：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">PATH</span> <span class="o">=</span> <span class="s1">'../model/cifar_net.pth'</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">PATH</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5.测试网络在测试集上的效果">
<a class="anchor" href="#5.%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9C%E5%9C%A8%E6%B5%8B%E8%AF%95%E9%9B%86%E4%B8%8A%E7%9A%84%E6%95%88%E6%9E%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>5.测试网络在测试集上的效果<a class="anchor-link" href="#5.%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9C%E5%9C%A8%E6%B5%8B%E8%AF%95%E9%9B%86%E4%B8%8A%E7%9A%84%E6%95%88%E6%9E%9C"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>我们在训练集上训练了两个epoch，现在检查下网络是否有学到什么东西。</p>
<p>我们通过预测网络对于测试集的输出，并将其与ground-truth相互对比，如果预测结果正确，则将结果加入正确预测列表之内。</p>
<p>首先，看下测试集中的一个minibatch：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataiter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">testloader</span><span class="p">)</span>
<span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">dataiter</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

<span class="c1"># 打印图片</span>
<span class="n">imshow</span><span class="p">(</span><span class="n">torchvision</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">make_grid</span><span class="p">(</span><span class="n">images</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'GroundTruth:'</span><span class="p">,</span> <span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">'</span><span class="si">%5s</span><span class="s1">'</span> <span class="o">%</span> <span class="n">classes</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>GroundTruth:   cat  ship  ship plane
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>之后，我们加载已经读取的模型：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="n">net</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">PATH</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;All keys matched successfully&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>现在我们看看网络认为上述示例是什么类型：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">outputs</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>输出的是10个类别的分数。某个类别的分数越高，网络就越是认为样本属于这个类别。因此我们获取具有最大分数的类别作为结果：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">predicted</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Predicted: '</span><span class="p">,</span> <span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">'</span><span class="si">%5s</span><span class="s1">'</span> <span class="o">%</span> <span class="n">classes</span><span class="p">[</span><span class="n">predicted</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Predicted:   frog  ship  ship plane
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>？错了一个，和原始教程中不一样。
我们再看看网络在整个数据集上的表现：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">testloader</span><span class="p">:</span>
        <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">predicted</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">outputs</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">labels</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">correct</span> <span class="o">+=</span> <span class="p">(</span><span class="n">predicted</span> <span class="o">==</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        
<span class="nb">print</span><span class="p">(</span><span class="s1">'Accuracy of the network on the 10000 test images: </span><span class="si">%d</span><span class="s1"> </span><span class="si">%%</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">correct</span> <span class="o">/</span> <span class="n">total</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Accuracy of the network on the 10000 test images: 55 %
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>看起来比随机猜测好很多（随机猜测有10%的概率猜中，准确率的期望为 10%）。网络学到了一些东西。</p>
<p>我们看看在哪些类别上网络表现好，哪些差：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">class_correct</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="mf">0.</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">class_total</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="mf">0.</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">testloader</span><span class="p">:</span>
        <span class="n">image</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">predicted</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">predicted</span> <span class="o">==</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">class_correct</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">+=</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
            <span class="n">class_total</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Accuracy of </span><span class="si">%5s</span><span class="s1"> : </span><span class="si">%2d</span><span class="s1"> </span><span class="si">%%</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">classes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">class_correct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">class_total</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Accuracy of plane :  0 %
Accuracy of   car : 26 %
Accuracy of  bird :  0 %
Accuracy of   cat : 24 %
Accuracy of  deer :  0 %
Accuracy of   dog : 25 %
Accuracy of  frog :  0 %
Accuracy of horse : 25 %
Accuracy of  ship :  0 %
Accuracy of truck :  0 %
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>我们该如何在GPU上运行这些网络呢？</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="在GPU上运行">
<a class="anchor" href="#%E5%9C%A8GPU%E4%B8%8A%E8%BF%90%E8%A1%8C" aria-hidden="true"><span class="octicon octicon-link"></span></a>在GPU上运行<a class="anchor-link" href="#%E5%9C%A8GPU%E4%B8%8A%E8%BF%90%E8%A1%8C"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>可以用和迁移Tensor一样的方法将网络迁移到GPU上。
首先设置设备为首个cuda设备，如果cuda可用的话：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cuda:0"</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">"cpu"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cuda:0
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>如若机器上有CUDA设备，那么这些方法将递归地遍历所有模块，并将它们的参数和缓存转换为cuda上的张量：</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Net(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>同时，你也需要将每一步的输入和目标送个GPU:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inputs</span><span class="p">,</span><span class="n">labels</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>为什么GPU速度没有明显提升呢？因为网络太小了。</p>
<p><strong>练习</strong>增加网络的宽度（首个nn.Conv2d的第二个参数与第二个nn.Conv2d的第一个参数），看看加速能达到多少。</p>
<p>目标完成：</p>
<ul>
<li>理解Tensor库和神经网络</li>
<li>训练一个小的神经网络用于分类图片</li>
</ul>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="henryalps/fastpages"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/fastpages/jupyter/pytorch/2020/05/30/Getting-Pytorch-one-hour.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/fastpages/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/fastpages/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/fastpages/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Practise, Record, Knowledge</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/henryalps" target="_blank" title="henryalps"><svg class="svg-icon grey"><use xlink:href="/fastpages/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/henryalps" target="_blank" title="henryalps"><svg class="svg-icon grey"><use xlink:href="/fastpages/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
